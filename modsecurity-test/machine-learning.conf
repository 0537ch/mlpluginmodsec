# ModSecurity configuration for ML plugin

# Enable ModSecurity
SecRuleEngine On

# Enable Debug Log
SecDebugLog "${APACHE_LOG_DIR}/modsec_debug.log"
SecDebugLogLevel 9

# Test rule without Lua first
SecRule REQUEST_URI ".*" \
    "id:100000,\
    phase:1,\
    t:none,\
    setvar:tx.test_uri=%{REQUEST_URI},\
    setvar:tx.test_method=%{REQUEST_METHOD},\
    log,msg:'Captured request info',\
    pass"

# Log the variables
SecRule TX:test_uri ".*" \
    "id:100001,\
    phase:2,\
    t:none,\
    log,msg:'URI: %{TX.test_uri}, Method: %{TX.test_method}',\
    pass"
